<!doctype html>

<html
  lang="en"
  class="layout-menu-fixed layout-compact"
  data-assets-path="../assets/"
  data-template="vertical-menu-template-free">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

    <title>SAPD Tools</title>

    <meta name="description" content="" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../assets/img/logo.png" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
      rel="stylesheet" />

      <link rel="stylesheet" href="https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.css">

    <link rel="stylesheet" href="../assets/vendor/fonts/iconify-icons.css" />
    <style>
      .icon-card {
        transition: box-shadow 0.3s ease; /* transisi halus saat hover */
      }

      .icon-card:hover {
        box-shadow: 0 0 10px rgba(0, 123, 255, 0.226) !important; /* bayangan biru saat hover */
      }
    </style>

    <!-- Core CSS -->
    <!-- build:css assets/vendor/css/theme.css  -->

    <link rel="stylesheet" href="../assets/vendor/css/core.css" />
    <link rel="stylesheet" href="../assets/css/demo.css" />

    <!-- Vendors CSS -->

    <link rel="stylesheet" href="../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />

    <!-- endbuild -->

    <!-- Page CSS -->

    <!-- Helpers -->

    <script src="../assets/vendor/js/helpers.js"></script>
    <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->

    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->

    <script src="../assets/js/config.js"></script>
  </head>

  <body>
    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar">
      <div class="layout-container">
        <!-- Menu -->

        <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
          <div class="app-brand demo">
            <a href="dashboard.html" class="app-brand-link">
              <span class="app-brand-logo demo">
                <span class="text-primary">
                  <img src="../assets/img/logo.png" style="width: 2.3rem;">
                </span>
              </span>
              <span class="app-brand-text demo menu-text  ms-2">SAPD Tools</span>
            </a>

            <a href="javascript:void(0);" class="layout-menu-toggle menu-link text-large ms-auto">
              <i class="bx bx-chevron-left d-block d-xl-none align-middle"></i>
            </a>
          </div>

          <div class="menu-divider mt-0"></div>

          <div class="menu-inner-shadow"></div>

          <ul class="menu-inner py-1">
            <!-- Dashboards -->
            <li class="menu-item ">
              <a href="dashboard.html" class="menu-link">
                <i class="menu-icon tf-icons bx bx-home-smile"></i>
                <div class="text-truncate" data-i18n="Dashboards">Dashboard</div>
              </a>
            </li>
            <li class="menu-item active">
              <a href="penal.html" class="menu-link">
                <i class="menu-icon tf-icons bx bx-file"></i>
                <div class="text-truncate" data-i18n="Dashboards">Penal Code</div>
              </a>
            </li>


            <!-- <li class="menu-item open">
              <a href="javascript:void(0);" class="menu-link menu-toggle">
                <i class="menu-icon tf-icons bx bx-support"></i>
                <div class="text-truncate" data-i18n="Public Service">Public Tools</div>
              </a>
              <ul class="menu-sub">
                <li class="menu-item">
                  <a href="index.html" class="menu-link">
                    <div class="text-truncate" data-i18n="Recruitment BBCcode">Recruitment BBCcode</div>
                  </a>
                </li>
              </ul>
            </li> -->

        </aside>
        <!-- / Menu -->

        <!-- Layout container -->
        <div class="layout-page">
          <!-- Navbar -->

          <nav
            class="layout-navbar container-xxl navbar-detached navbar navbar-expand-xl align-items-center bg-navbar-theme"
            id="layout-navbar">
            <div class="layout-menu-toggle navbar-nav align-items-xl-center me-4 me-xl-0 d-xl-none">
              <a class="nav-item nav-link px-0 me-xl-6" href="javascript:void(0)">
                <i class="icon-base bx bx-menu icon-md"></i>
              </a>
            </div>

            <div class="navbar-nav-right d-flex align-items-center justify-content-end" id="navbar-collapse">
              <!-- Search -->
              <div class="navbar-nav align-items-center me-auto">
                  Penal Code System
              </div>
              <!-- /Search -->

              <ul class="navbar-nav flex-row align-items-center ms-md-auto">
                <!-- Place this tag where you want the button to render. -->
                <li class="nav-item lh-1 me-4">
                </li>

                <!-- User -->
                <li class="nav-item navbar-dropdown dropdown-user dropdown">
                  <a
                    class="nav-link dropdown-toggle hide-arrow p-0"
                    href="javascript:void(0);"
                    data-bs-toggle="dropdown">
                    <div class="avatar avatar-online">
                      <img src="../assets/img/avatars/1.png" alt class="w-px-40 h-auto rounded-circle" />
                    </div>
                  </a>
                  <ul class="dropdown-menu dropdown-menu-end">
                    <li>
                      <a class="dropdown-item" href="#">
                        <div class="d-flex">
                          <div class="flex-shrink-0 me-3">
                            <div class="avatar avatar-online">
                              <img src="../assets/img/avatars/1.png" alt class="w-px-40 h-auto rounded-circle" />
                            </div>
                          </div>
                          <div class="flex-grow-1">
                            <h6 class="mb-0">SAPD Tools Visitor</h6>
                            <small class="text-body-secondary">Visitor</small>
                          </div>
                        </div>
                      </a>
                    </li>
                  </ul>
                </li>
                <!--/ User -->
              </ul>
            </div>
          </nav>

          <!-- / Navbar -->

          <!-- Content wrapper -->
          <div class="content-wrapper">
            <!-- Content -->
            <div class="container-xxl flex-grow-1 container-p-y">
              <!-- Content -->
  <div class="container-xxl flex-grow-1 container-p-y">

    <!-- Input Suspect ID -->
    <div class="card mb-4">
      <div class="card-body">
        <div class="row g-2">
          <div class="col-md-10">
            <input type="text" class="form-control" id="suspectid" placeholder="Suspect ID">
          </div>
          <div class="col-md-2 d-grid">
            <button class="btn btn-light">Apply</button>
          </div>
        </div>
      </div>
    </div>


    <!-- Violations Added Table -->
    <div class="card mb-4">
      <div class="card-body table-responsive">
        <table id="violate-select" class="table table-hover">
          <thead class="table-light">
            <tr>
              <th>#</th>
              <th>Violation</th>
              <th>Jailtime</th>
              <th>Fine</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Arrest Command -->
    <div class="card p-4 mb-4">
        <div class="input-group mb-2">
            <input type="text" id="arrest" class="form-control" readonly>
            <span class="input-group-text">
                <button id="copyarrest" class="btn btn-sm btn-info">Copy</button>
            </span>
        </div>
    </div>

    <!-- Charges Section -->
    <div class="card mb-4">
      <div class="card-header fw-semibold">Charges</div>
      <div class="card-body d-grid gap-2" id="individual-charges-container">
      </div>
    </div>

    <!-- Tickets Section -->
    <div class="card mb-4">
      <div class="card-header fw-semibold">Tickets</div>
      <div class="card-body d-grid gap-2" id="individual-tickets-container">
      </div>
    </div>

    <!-- Search Violation Input -->
    <div class="card mb-4">
      <div class="card-body">
        <input type="text" id="violationSearchInput" class="form-control" placeholder="Cari nomor pelanggaran ...">
      </div>
    </div>

    <!-- Full Violations Table -->
    <div class="card">
      <div class="card-header fw-semibold">Violation List</div>
      <div class="card-body table-responsive">
        <table class="table table-bordered" id="violate-data">
          <thead class="table-light">
            <tr>
              <th>#</th>
              <th>Violation</th>
              <th>Jailtime</th>
              <th>Fine</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
      </div>
    </div>

            </div>
            <!-- / Content -->

            <!-- Footer -->
            <footer class="content-footer footer bg-footer-theme">
              <div class="container-xxl">
                <div
                  class="footer-container d-flex align-items-center justify-content-between py-4 flex-md-row flex-column">
                  <div class="mb-2 mb-md-0">
                    &#169;
                    SAPD Public Information and Media
                    <script>
                      document.write(new Date().getFullYear());
                    </script>
                  </div>
                </div>
              </div>
            </footer>
            <!-- / Footer -->

            <div class="content-backdrop fade"></div>
          </div>
          <!-- Content wrapper -->
        </div>
        <!-- / Layout page -->
      </div>

      <!-- Overlay -->
      <div class="layout-overlay layout-menu-toggle"></div>
    </div>
    <!-- / Layout wrapper -->


    <!-- Core JS -->

    <script src="../assets/vendor/libs/jquery/jquery.js"></script>

    <script src="../assets/vendor/libs/popper/popper.js"></script>
    <script src="../assets/vendor/js/bootstrap.js"></script>

    <script src="../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>

    <script src="../assets/vendor/js/menu.js"></script>

    <!-- endbuild -->

    <!-- Vendors JS -->

    <!-- Main JS -->

    <script src="../assets/js/main.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.js"></script>

    <script>
      $(document).ready(function() {

            /**
             * Fungsi untuk menyalin teks ke clipboard.
             * @param {string} text - Teks yang akan disalin.
             */
            function copyToClipboard(text) {
                var textarea = document.createElement('textarea');
                textarea.value = text;
                textarea.style.position = 'fixed'; // Mengatur posisi tetap agar tidak mengganggu tata letak
                document.body.appendChild(textarea);
                textarea.select(); // Memilih teks di dalam textarea
                document.execCommand('copy'); // Menyalin teks ke clipboard
                document.body.removeChild(textarea); // Menghapus textarea setelah disalin
            }

            // --- Event Listener untuk Tombol Copy Utama ---
            $('#copyarrest').click(function () {
                copyToClipboard($('#arrest').val());
            });

            $('#copytickets').click(function () {
                copyToClipboard($('#tickets').val());
            });

            $('#copycharges').click(function () {
                copyToClipboard($('#charges').val());
            });
            // --- Akhir Event Listener untuk Tombol Copy Utama ---


          let suspectid = 0;
          let jailtime = 0;
          let fine = 0;
          let maxjailtime = 60;
          let maxfine = 50000;
          let selectedChargesData = []; // Array untuk menyimpan detail biaya yang dipilih (selalu /su)
          let selectedTicketsData = []; // Array untuk menyimpan detail tiket yang dipilih (selalu /ticket)

          let jsonData = [
            {
               code: "1A1",
               name: "General Traffic Violation",
               jailtime: "0",
               fine: "250"
            },
            {
               code: "1A2",
               name: "Failure to pay any issued ticket",
               jailtime: "15",
               fine: "65"
            },
            {
               code: "1A3",
               name: "Driving any motorized vehicle without an official driving license",
               jailtime: "15",
               fine: "100"
            },
            {
               code: "1A4",
               name: "Maneuver any sea vehicles without official sailing licenses",
               jailtime: "15",
               fine: "100"
            },
            {
               code: "1A5a",
               name: "Driving any heavy truck without official trucking licenses",
               jailtime: "30",
               fine: "1500"
            },
            {
               code: "1A5b",
               name: "Driving any lorry truck without official trucking licenses",
               jailtime: "30",
               fine: "500"
            },
            {
               code: "1A6a",
               name: "Truck driving in any federal roads, in any inappropriate path, and without any permission from officers before",
               jailtime: "30",
               fine: "2000"
            },
            {
               code: "1A6b",
               name: "Lorry driving in any federal roads, in any inappropriate path, and without any permission from officers before",
               jailtime: "30",
               fine: "200"
            },
            {
               code: "1A7",
               name: "Flying any air vehicles without official flying licenses as a pilot",
               jailtime: "35",
               fine: "2250"
            },
            {
               code: "1A8",
               name: "Speeding",
               jailtime: "0",
               fine: "1000"
            },
            {
               code: "1A9",
               name: "Vehicle Parking Violation",
               jailtime: "0",
               fine: "450"
            },
            {
               code: "1A10",
               name: "Illegal Modifications On Vehicles",
               jailtime: "0",
               fine: "500"
            },
            {
               code: "1A11",
               name: "Unregistered Vehicles",
               jailtime: "0",
               fine: "250"
            },
            {
               code: "1A12",
               name: "Vehicular Endangerment",
               jailtime: "30",
               fine: "3000"
            },
            {
               code: "1A13",
               name: "Vehicular Manslaughter",
               jailtime: "40",
               fine: "450",
            },
            {
               code: "1A14",
               name: "DWI or DUI",
               jailtime: "15",
               fine: "300"
            },
            {
               code: "1A15",
               name: "Illegal Street Racing",
               jailtime: "25",
               fine: "350"
            },
            {
               code: "1A16",
               name: "Evading From Police",
               jailtime: "20",
               fine: "250"
            },
            {
               code: "1A17",
               name: "Flight Regulations",
               jailtime: "0",
               fine: "450"
            },
            {
               code: "1A18",
               name: "Misbehavely Maneuvering / Operating an Aircraft / Aircraft Endangerment",
               jailtime: "50",
               fine: "750"
            },
            {
               code: "1S",
               name: "Emergency Landing",
               jailtime: "0",
               fine: "400"
            },
            {
               code: "1T",
               name: "Failure to Yield to Emergency Vehicles",
               jailtime: "0",
               fine: "250"
            },
            {
               code: "1U",
               name: "Failure to Yield to A Roadblock",
               jailtime: "0",
               fine: "200"
            },
            {
               code: "1V",
               name: "Following An Emergency Vehicle",
               jailtime: "0",
               fine: "300"
            },
            {
               code: "1W",
               name: "Altering or Changing a Vehicle Identification Number",
               jailtime: "20",
               fine: "100"
            },
            {
               code: "2D",
               name: "Lumberjack License",
               jailtime: "25",
               fine: "2000"
            },
            {
               code: "2F",
               name: "Organizing a Small Illegal Event",
               jailtime: "25",
               fine: "5000"
            },
            {
               code: "2G",
               name: "Organizing a Big Illegal Event",
               jailtime: "35",
               fine: "7500"
            },
            {
               code: "3A",
               name: "Possessing of Marijuana / Pots (Small Amount)",
               jailtime: "5",
               fine: "400"
            },
            {
               code: "3B",
               name: "Possessing of Marijuana / Pots (Large Amount)",
               jailtime: "5",
               fine: "1200"
            },
            {
               code: "3C",
               name: "Possessing of Cocaine / Crack (Small Amount)",
               jailtime: "20",
               fine: "375"
            },
            {
               code: "3D",
               name: "Possessing of Cocaine / Crack (Large Amount)",
               jailtime: "25",
               fine: "750"
            },
            {
               code: "3E",
               name: "IUI or IWI",
               jailtime: "15",
               fine: "150"
            },
            {
               code: "3F",
               name: "Selling or distributing of illegal drugs",
               jailtime: "25",
               fine: "500"
            },
            {
               code: "3G",
               name: "Drug Manufacturing",
               jailtime: "35",
               fine: "500"
            },
            {
               code: "3H",
               name: "Being Present for Illegal Drug Use",
               jailtime: "10",
               fine: "100"
            },
            {
               code: "4A",
               name: "Possessing, Showing, And Display Any Usages of Sharp / Blunt Weapons",
               jailtime: "15",
               fine: "150"
            },
            {
               code: "4B",
               name: "Possessing of Illegal Firearms",
               jailtime: "40",
               fine: "500"
            },
            {
               code: "4C",
               name: "Possessing of Legal Firearms Without Official Firearms License",
               jailtime: "20",
               fine: "50"
            },
            {
               code: "4D",
               name: "Possessing Any Kind of Weapon Materials or Schematics",
               jailtime: "25",
               fine: "500"
            },
            {
               code: "4F",
               name: "Brandishing a Firearm or Weapon",
               jailtime: "20",
               fine: "200"
            },
            {
               code: "4G",
               name: "Unlawful Discharge of a Firearm or Weapon",
               jailtime: "25",
               fine: "200"
            },
            {
               code: "4H",
               name: "Possession of a Body Armor",
               jailtime: "10",
               fine: "400"
            },
            {
               code: "4I",
               name: "Weapon Trafficking",
               jailtime: "30",
               fine: "400"
            },
            {
               code: "4J",
               name: "Possessing Destructive Devices or Explosives",
               jailtime: "35",
               fine: "350"
            },
            {
               code: "5A",
               name: "Intimidation",
               jailtime: "10",
               fine: "50"
            },
            {
               code: "5B",
               name: "Assault",
               jailtime: "15",
               fine: "100"
            },
            {
               code: "5C",
               name: "Assault with Deadly Weapons",
               jailtime: "20",
               fine: "150"
            },
            {
               code: "5D",
               name: "Battery",
               jailtime: "25",
               fine: "200"
            },
            {
               code: "5E",
               name: "Aggravated Battery",
               jailtime: "30",
               fine: "250"
            },
            {
               code: "5F",
               name: "Attempted Murdering",
               jailtime: "30",
               fine: "200"
            },
            {
               code: "5G",
               name: "Murdering",
               jailtime: "50",
               fine: "400"
            },
            {
               code: "5H",
               name: "Committed a group criminal assault with or without weapons",
               jailtime: "30",
               fine: "250"
            },
            {
               code: "5I",
               name: "Performing A Drive-By Using Light or Heavy Fire Arms",
               jailtime: "35",
               fine: "300"
            },
            {
               code: "5J",
               name: "Melee Robbery",
               jailtime: "15",
               fine: "100"
            },
            {
               code: "5K",
               name: "Armed Robbery",
               jailtime: "30",
               fine: "150"
            },
            {
               code: "5L",
               name: "Piracy",
               jailtime: "20",
               fine: "150"
            },
            {
               code: "5M",
               name: "Grand Theft",
               jailtime: "25",
               fine: "250"
            },
            {
               code: "5N",
               name: "Grand Theft Auto",
               jailtime: "15",
               fine: "250"
            },
            {
               code: "5O",
               name: "Grand Theft of Firearms",
               jailtime: "15",
               fine: "100"
            },
            {
               code: "5P",
               name: "Abuse or Desecration of Dead Human Body",
               jailtime: "15",
               fine: "200"
            },
            {
               code: "5Q",
               name: "Kidnapping",
               jailtime: "30",
               fine: "350"
            },
            {
               code: "5R",
               name: "Hostage Taking",
               jailtime: "60",
               fine: "250"
            },
            {
               code: "5S",
               name: "Torture",
               jailtime: "20",
               fine: "150"
            },
            {
               code: "5T",
               name: "Blackmail",
               jailtime: "10",
               fine: "100"
            },
            {
               code: "5U",
               name: "Human Trafficking",
               jailtime: "65",
               fine: "550"
            },
            {
               code: "6A",
               name: "Sexual Harassment",
               jailtime: "10",
               fine: "500"
            },
            {
               code: "6B",
               name: "Rape",
               jailtime: "60",
               fine: "300"
            },
            {
               code: "6C",
               name: "Statutory Rape",
               jailtime: "75",
               fine: "500"
            },
            {
               code: "6D",
               name: "Prostitution",
               jailtime: "30",
               fine: "250"
            },
            {
               code: "6E",
               name: "Solicitation of Sexual Engagement",
               jailtime: "30",
               fine: "250"
            },
            {
               code: "6F",
               name: "Being Naked In Public",
               jailtime: "5",
               fine: "50"
            },
            {
               code: "6G",
               name: "Performs Any Sexual Action in Public",
               jailtime: "15",
               fine: "150"
            },
            {
               code: "7A",
               name: "Initiating A Riot",
               jailtime: "15",
               fine: "200"
            },
            {
               code: "7B",
               name: "Failing to Disperse After Lawfully Ordered by The Officials",
               jailtime: "20",
               fine: "250"
            },
            {
               code: "7C",
               name: "Participating in a Riot",
               jailtime: "10",
               fine: "75"
            },
            {
               code: "7D",
               name: "Spitting in Public Space",
               jailtime: "0",
               fine: "150"
            },
            {
               code: "7E",
               name: "Pee in Public",
               jailtime: "0",
               fine: "150"
            },
            {
               code: "7F",
               name: "Drunk in Public Space",
               jailtime: "0",
               fine: "200"
            },
            {
               code: "7G",
               name: "Vilification",
               jailtime: "15",
               fine: "100"
            },
            {
               code: "7H",
               name: "Hate Speech",
               jailtime: "20",
               fine: "150"
            },
            {
               code: "7I",
               name: "Vigilantism",
               jailtime: "30",
               fine: "300"
            },
            {
               code: "7J",
               name: "Disturbing Public Peace",
               jailtime: "15",
               fine: "100"
            },
            {
               code: "7K",
               name: "Brawl in Public Space",
               jailtime: "20",
               fine: "150"
            },
            {
               code: "7M",
               name: "Jaywalk",
               jailtime: "0",
               fine: "50"
            },
            {
               code: "7N",
               name: "Littering the Public Facility / Space",
               jailtime: "0",
               fine: "250"
            },
            {
               code: "7O",
               name: "Unlawful Assembly",
               jailtime: "20",
               fine: "100"
            },
            {
               code: "7P",
               name: "Stalking",
               jailtime: "20",
               fine: "200"
            },
            {
               code: "7Q",
               name: "Public Intoxication",
               jailtime: "10",
               fine: "250"
            },
            {
               code: "7R",
               name: "Animal Abuse",
               jailtime: "20",
               fine: "500"
            },
            {
               code: "7S",
               name: "Animal Cruelty",
               jailtime: "0",
               fine: "300"
            },
            {
               code: "8A",
               name: "Obstruction of Justice",
               jailtime: "15",
               fine: "30"
            },
            {
               code: "8B",
               name: "Abusing Government Hotline",
               jailtime: "10",
               fine: "100"
            },
            {
               code: "8C",
               name: "Governments Attribute",
               jailtime: "60",
               fine: "100"
            },
            {
               code: "8D",
               name: "Impersonating Government Staff",
               jailtime: "60",
               fine: "100"
            },
            {
               code: "8E",
               name: "Attempting to Bribe or Corrupt Any Public Officials",
               jailtime: "15",
               fine: "200"
            },
            {
               code: "8F",
               name: "Attempting to bribe, corrupt or prevent any crime’s witnesses to step out and give out information to law enforcers",
               jailtime: "10",
               fine: "60"
            },
            {
               code: "8G",
               name: "Making a False Report",
               jailtime: "20",
               fine: "200"
            },
            {
               code: "8H",
               name: "Giving False Information to the Police Officials",
               jailtime: "20",
               fine: "125"
            },
            {
               code: "8I",
               name: "Perjury",
               jailtime: "20",
               fine: "500"
            },
            {
               code: "8J",
               name: "Assaulting on LEO",
               jailtime: "40",
               fine: "150"
            },
            {
               code: "8K",
               name: "Attempted Murdering A Public Officials",
               jailtime: "60",
               fine: "500"
            },
            {
               code: "8L",
               name: "Murdering A Public Officials",
               jailtime: "70",
               fine: "600"
            },
            {
               code: "8M",
               name: "Harbouring Criminals",
               jailtime: "30",
               fine: "250"
            },
            {
               code: "8N",
               name: "Fraud / Scam",
               jailtime: "20",
               fine: "250"
            },
            {
               code: "8O",
               name: "Forgery",
               jailtime: "30",
               fine: "500"
            },
            {
               code: "8P",
               name: "Corruption",
               jailtime: "300",
               fine: "5000"
            },
            {
               code: "9A",
               name: "Trespassing",
               jailtime: "5",
               fine: "300"
            },
            {
               code: "9B",
               name: "Trespassing Government Property",
               jailtime: "20",
               fine: "100"
            },
            {
               code: "9C",
               name: "Vandalism",
               jailtime: "15",
               fine: "250"
            },
            {
               code: "9D",
               name: "Arson",
               jailtime: "30",
               fine: "250"
            },
            {
               code: "9E",
               name: "Extortion",
               jailtime: "20",
               fine: "150"
            },
            {
               code: "9F",
               name: "Using Property As Illegal Distribution",
               jailtime: "60",
               fine: "300"
            }
         ];
            var tableBody = $("#violate-data tbody");

            /**
             * Fungsi untuk mengisi tabel data pelanggaran.
             */
            $.each(jsonData, function(index, charge) {
              var row = $("<tr></tr>");
              row.append($("<td></td>").text(charge.code));
              row.append($("<td></td>").text(charge.name));
              row.append($("<td></td>").text(charge.jailtime));
              row.append($("<td></td>").text(charge.fine));
              var button = $("<td></td>");
              var convertcharge = 'item-' + charge.code.replace(/[ .]/g, function(match) {
              return match === ' ' ? '-' : '';
              });

              button.append($('<button type="button" class="btn btn-sm btn-success">Add</button>').attr('id', convertcharge).attr('code', charge.code));
              row.append(button);

              tableBody.append(row);
            });

            $('#violationTable').on('click', 'button.btn-success', function () {
              const code = $(this).attr('code');
              const charge = jsonData.find(c => c.code === code);

              if (!charge) return;

              const formatted = `/su 0 ${charge.code}. ${charge.name}`;
              const inputGroup = $(`
                <div class="input-group mb-2">
                  <input type="text" class="form-control" readonly value="${formatted}">
                  <button class="btn btn-outline-secondary copy-btn">Copy</button>
                </div>
              `);

              $('.card-body.d-grid').append(inputGroup);
            });


            /**
             * Inisialisasi DataTable untuk #violate-data.
             */
            $('#violate-data').DataTable({
                "order": [[0, "asc"]],
                "paging": false,
                responsive: true,
                "searching": false
            });

            /**
             * Inisialisasi DataTable untuk #violate-select.
             */
            var dataselect = new DataTable('#violate-select', {
              "order": [[0, "asc"]],
              "paging": false,
              responsive: true
            });

            /**
             * Fungsi utama untuk memperbarui semua detail penangkapan, biaya, dan tiket.
             */
            function updateArrestDetails() {
                jailtime = 0;
                fine = 0;
                selectedChargesData = []; // Bersihkan data biaya yang dipilih sebelumnya
                selectedTicketsData = []; // Bersihkan data tiket yang dipilih sebelumnya

                dataselect.rows().data().each(function (value) {
                    let chargeCode = value[0];
                    let chargeName = value[1];
                    let chargeJailtime = parseInt(value[2], 10);
                    let chargeFine = parseInt(value[3], 10);

                    jailtime += chargeJailtime;
                    fine += chargeFine;

                    // Untuk bagian 'Charges' (biaya individual), selalu gunakan /su
                    let chargeCommand = `/su ${suspectid} ${chargeCode}. ${chargeName}`;

                    selectedChargesData.push({
                        code: chargeCode,
                        name: chargeName,
                        jailtime: chargeJailtime, // Tetap simpan jailtime
                        fine: chargeFine, // Tetap simpan fine
                        command: chargeCommand
                    });

                    // Untuk bagian 'Tickets' (tiket individual), selalu gunakan /ticket jika jailtime 0
                    if (chargeJailtime === 0) {
                        let ticketCommand = `/ticket ${suspectid} ${chargeFine} ${chargeCode}. ${chargeName}`;
                        selectedTicketsData.push({
                            code: chargeCode,
                            name: chargeName,
                            jailtime: chargeJailtime,
                            fine: chargeFine,
                            command: ticketCommand
                        });
                    }
                });

                // Perbarui Jailtime dan Fine dengan batas maksimum
                const finalJailtime = jailtime < maxjailtime ? jailtime : maxjailtime;
                const finalFine = fine < maxfine ? fine : maxfine;

                $('#arrest').val(`/arrest ${suspectid} ${finalJailtime} ${finalFine}`);

                // Panggil fungsi untuk merender tabel biaya individual
                renderIndividualCharges();
                // Panggil fungsi untuk merender tabel tiket individual
                renderIndividualTickets();
                // Panggil fungsi untuk memperbarui textarea gabungan
            }

            /**
             * Fungsi untuk merender baris biaya individual yang dapat disalin.
             */
            function renderIndividualCharges() {
                const chargesContainer = $('#individual-charges-container');
                chargesContainer.empty(); // Bersihkan biaya individual sebelumnya

                if (selectedChargesData.length === 0) {
                    chargesContainer.append('<p class="text-muted">There is No Charges Selected.</p>');
                    return;
                }

                selectedChargesData.forEach(charge => {
                    const chargeHtml = `
                        <div class="input-group mb-2">
                            <span class="input-group-text">${charge.code} - ${charge.name}:</span>
                            <input type="text" class="form-control" value="${charge.command}" readonly>
                            <span class="input-group-text">
                                <button type="button" class="btn btn-sm btn-info copy-individual-charge" data-command="${charge.command}">Copy</button>
                            </span>
                        </div>
                    `;
                    chargesContainer.append(chargeHtml);
                });

                // Lampirkan event click untuk tombol copy yang baru dibuat
                $('.copy-individual-charge').off('click').on('click', function() {
                    const commandToCopy = $(this).data('command');
                    copyToClipboard(commandToCopy);
                });
            }

            /**
             * Fungsi untuk merender baris tiket individual yang dapat disalin.
             */
            function renderIndividualTickets() {
                const ticketsContainer = $('#individual-tickets-container');
                ticketsContainer.empty(); // Bersihkan tiket individual sebelumnya

                if (selectedTicketsData.length === 0) {
                    ticketsContainer.append('<p class="text-muted">There is no ticket selected (charges with 0 jailtime).</p>');
                    return;
                }

                selectedTicketsData.forEach(ticket => {
                    const ticketHtml = `
                        <div class="input-group mb-2">
                            <span class="input-group-text">${ticket.code} - ${ticket.name}:</span>
                            <input type="text" class="form-control" value="${ticket.command}" readonly>
                            <span class="input-group-text">
                                <button type="button" class="btn btn-sm btn-info copy-individual-ticket" data-command="${ticket.command}">Copy</button>
                            </span>
                        </div>
                    `;
                    ticketsContainer.append(ticketHtml);
                });

                // Lampirkan event click untuk tombol copy yang baru dibuat
                $('.copy-individual-ticket').off('click').on('click', function() {
                    const commandToCopy = $(this).data('command');
                    copyToClipboard(commandToCopy);
                });
            }


      let debounceTimer;
      $('#violationSearchInput').on('input', function () {
        clearTimeout(debounceTimer);

        debounceTimer = setTimeout(() => {
          const query = $(this).val().toLowerCase();
          const keywords = query
            .split(',')
            .map(word => word.trim())
            .filter(word => word.length > 0);

          $('#violate-data tbody tr').each(function () {
            const row = $(this);
            const code = row.find('td').eq(0).text().toLowerCase();
            const name = row.find('td').eq(1).text().toLowerCase();

            const isMatch = keywords.some(keyword =>
              code.includes(keyword) || name.includes(keyword)
            );

            row.toggle(isMatch || keywords.length === 0);
          });
        }, 300); // 300ms delay
      });


            // --- Event Listener untuk Tombol Add/Remove Violations ---
            $('#violate-data').on('click', '.btn-success', function () {
                let result = jsonData.filter(x=> x.code == $(this).attr("code"));
                $(this).prop("disabled", true);

                $.each(result, function(index, charge) {
                  dataselect.row
                  .add([charge.code, charge.name, charge.jailtime, charge.fine,
                        `<button type="button" class="btn btn-sm btn-danger" code="${charge.code}">Remove</button>`])
                  .draw();
                });
                updateArrestDetails(); // Panggil setelah menambahkan pelanggaran
            });

            $('#violate-select').on('click', '.btn-danger', function () {
                let removedCode = $(this).attr("code");
                dataselect
                .row($(this).parents('tr'))
                .remove()
                .draw();

                // Aktifkan kembali tombol "Add" untuk item yang dihapus di tabel violate-data
                $(`button[code="${removedCode}"].btn-success`).prop("disabled", false);

                updateArrestDetails(); // Panggil setelah menghapus pelanggaran
            });
            // --- Akhir Event Listener untuk Tombol Add/Remove Violations ---

            /**
             * Event Listener untuk tombol "Apply" suspect ID.
             */
            $('.btn-light').click(function () {
              suspectid = $('#suspectid').val();
              updateArrestDetails(); // Panggil ketika ID tersangka berubah
            });

            // Panggil updateArrestDetails saat dokumen siap untuk inisialisasi awal
            // Ini memastikan nilai default tampil bahkan tanpa input atau add/remove pertama kali.
            updateArrestDetails();
      });
    </script>

    <!-- Page JS -->

    <!-- Place this tag before closing body tag for github widget button. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
  </body>
</html>
